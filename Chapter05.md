# Chapter05

# 高效模型

[TOC]

## 1、通道优化

### （1）1X1卷积与3X3卷积

![image-20200902154016973](image/image-20200902154016973.png)

![image-20200902153929649](image/image-20200902153929649.png)

3X3的卷积在输出的宽高维度上，1个特征值连接输入的9个值，也为像素融合。而在通道层面为全连接的形式。

1X1的卷积在输出的宽高维度上，1个特征值连接输入的1个值通道层面为全连接的形式。1x1卷积则在空间上没有融合，只在通道间进行信息融合。

1X1卷积与3X3卷积在通道层面皆为全连接形式。

### （2）分离卷积

将通道层面的全连接转变为局部连接。通过将卷积进行分组，来完成。

![image-20200902161518739](image/image-20200902161518739.png)

在未分组前，卷积核的个数为6，卷积核大小为3X3，其通道数为6，以全连接的方式完成计算：

![image-20200902161710906](image/image-20200902161710906.png)

将其分组之后，则把输入的通道数，等分为两部分。这样卷积核的变为了3X3的大小，每个通道数降为3，数量不变为6。将第一组的三个通道的输入和第一组的3个卷积核做卷积运算，得到3个通道的输出；第二组的通道输入和第二组的3个卷积核做卷积运算，得到3个通道的输出。将两组的通道合并，则完成了这次分离卷积的运算。

![image-20200902161248028](image/image-20200902161248028.png)

则连接形式变为了如此：

![image-20200902160414595](image/image-20200902160414595.png)

要使用分离卷积使用代码，给groups传参数即可：

```python
nn.Conv2d(6,6,3,1,groups=2)  # groups参数需要能输入输出通道数整除它
```

![image-20200902160429740](image/image-20200902160429740.png)

![image-20200902160444717](image/image-20200902160444717.png)

![image-20200902160456822](image/image-20200902160456822.png)

查看算量

安装thop，`pip install thop`

[P5Calculation.py](Chapter05/P5Calculation.py)