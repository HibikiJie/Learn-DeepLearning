# Project 1

## MTCNN

## 多任务卷积神经网络

《Joint Face Detection and Alignment using Multi-task Cascaded Convolutional Networks》

## 目标识别的步骤

1. 目标侦测
2. 特征提取
3. 特征对比

## 目标侦测

单目标和多目标

![image-20200729103007950](D:\Learn-DeepLearning\image\image-20200729103007950.png)

定位目标，给左上角和右下角的两个坐标点，或是中心点和宽高的标签，进行回归运算。

如果图像目标中个数不定，则之前所用的无效，因为有全连接。

如何实现输出的目标不定，这需要利用到卷积神经网络的特性。

将**图片切分**，依次传入神经网络，让他判断是否有目标，目标所在的位置。

此时应输出5个值，x1、y1、x2、y2、置信度c。

此时，神经网络为**单目标检测的网络**。

然而图像切分时，因为神经网络使用特性，切分的大小应该固定大小。但图片中人脸有大有小，又需要使用不同大小的切分框。

使用不同大小的切分框，显然是不利的。可以通过**缩放图片**的形式，变相地改变切分框在图片上切分的大小。

如此将图像进行不同尺度的变换，**构建图像金字塔**，以适应不同大小的目标的进行检测。

在切分框扫描图像时，如果按照等分切分，则极大可能无法切分出完整人脸。因此**步长应为1**，则可保证所有的人脸可以完整切分出来。

实现切分过程，需要将切分出来的图像依次传入神经网络。切分框定为12*12的大小。

![image-20200729114002279](D:\Learn-DeepLearning\image\image-20200729114002279.png)

控制该神经网络的感受野为12*12，即输出的特征图的单个值，则对应的原图上切分。并输出5个通道，来分别代表坐标点和置信度。

则该单目标侦测网络，输入为（1,3,12,12）的数据，输出为（
1,5,1,1），并且该网络无全连接层。这便是MTCNN的P-Net网络。

## MTCNN网络结构

有三级网络构成：

1. **P-Net**
2. **R-Net**
3. **O-Net**

### P-Net

![image-20200729135355746](D:\Learn-DeepLearning\image\image-20200729135355746.png)

### R-Net

![image-20200729135443930](D:\Learn-DeepLearning\image\image-20200729135443930.png)

### O-Net

![image-20200729135546856](D:\Learn-DeepLearning\image\image-20200729135546856.png)

MTCNN为了兼顾性能和准确率，避免滑动窗口加分类器等传统思路带来的巨大的性能消耗，先使用小模型生成有一定可能性的目标区域候选框，然后在使用更复杂的模型进行细分类和更高精度的区域框回归，并且让这一步递归执行，以此思想构成三层网络，分别为P-Net、R-Net、O-Net，实现快速高效的人脸检测。在输入层使用图像金字塔进行初始图像的尺度变换，并使用P-Net生成大量的候选目标区域框，之后使用R-Net对这些目标区域框进行第一次精选和边框回归，排除大部分的负例，然后再用更复杂的、精度更高的网络O-Net对剩余的目标区域框进行判别和区域边框回归。